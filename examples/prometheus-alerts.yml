groups:
  - name: outlinews-alerts
    rules:

      - alert: UpstreamDown
        expr: outlinews_upstream_healthy == 0
        for: 1m
        labels:
          severity: critical
        annotations:
          description: "Upstream is down"

      - alert: FailureSpike
        expr: sum(rate(outlinews_upstream_failures_total[5m])) > 5
        for: 2m
        labels:
          severity: warning
        annotations:
          description: "Failure rate spike detected"

      - alert: HighLatencyP99
        expr: histogram_quantile(0.99, sum(rate(outlinews_ws_dial_duration_seconds_bucket[5m])) by (le)) > 1
        for: 3m
        labels:
          severity: warning
        annotations:
          description: "High p99 latency"
